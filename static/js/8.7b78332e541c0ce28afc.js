webpackJsonp([8],{"0FZS":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Xxa5"),r=s.n(a),i=s("exGp"),o=s.n(i),l=s("Dd8w"),n=s.n(l),c=s("4C6m"),u=s("Z8dt"),d=s("NYxO"),m={props:{},data:function(){var e=this,t=function(t,s,a){/^(?![A-Z]+$)(?![a-z]+$)(?!\d+$)\S{8,}$/.test(s)?s===e.alterForm.originPass?a(new Error("原密码与新密码相同")):(e.$refs.alterForm.validateField("checkPass"),a()):a(new Error("密码须由数字,大写字母,小写字母,至少其中两种组成"))},s=function(t,s,a){s!==e.alterForm.newPass?a(new Error("两次输入密码不一致!")):a()};return{dialogFormVisible:!1,alterForm:{originPass:"",newPass:"",checkPass:""},rules:{originPass:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPass:[{required:!0,message:"请输入新密码",trigger:"blur"},{required:!0,trigger:"blur",validator:t},{required:!0,trigger:"change",validator:t}],checkPass:[{required:!0,message:"请再次输入密码",trigger:"blur"},{required:!0,trigger:"blur",validator:s},{required:!0,trigger:"change",validator:s}]}}},methods:{alterPass:function(){var e=this,t=this.alterForm,s=t.originPass,a=t.newPass;this.$refs.alterForm.validate(function(t){if(!t)return!1;Object(u.a)().then(function(t){var r=new c.JSEncrypt;r.setPublicKey(t.data.resultmap);var i={originPass:r.encrypt(s),newPass:r.encrypt(a),username:e.name};e.$emit("alterPass",i)})})},cancel:function(e){this.dialogFormVisible=!1,this.$refs[e].resetFields()}},computed:n()({},Object(d.c)(["name"]))},v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"card card-large-icons"},[s("div",{staticClass:"card-icon bg-primary"},[s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"lock"}})],1)]),e._v(" "),s("div",{staticClass:"card-body"},[s("h4",[e._v("修改密码")]),e._v(" "),s("p",[e._v("定期修改为高强度密码以保护您的账号")]),e._v(" "),s("a",{staticClass:"card-cta",on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("\n      立即修改\n      "),s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"chevron-right"}})],1)])]),e._v(" "),s("el-dialog",{attrs:{top:"2%",width:"35%","close-on-click-modal":!1,title:"修改账号密码","custom-class":"alertPwd",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{ref:"alterForm",attrs:{rules:e.rules,model:e.alterForm}},[s("el-form-item",{attrs:{id:"labels",prop:"originPass",label:"原密码"}},[s("el-input",{ref:"originPass",attrs:{autocomplete:"off","show-password":"",clearable:""},model:{value:e.alterForm.originPass,callback:function(t){e.$set(e.alterForm,"originPass",t)},expression:"alterForm.originPass"}})],1),e._v(" "),s("el-form-item",{attrs:{id:"labels",prop:"newPass",label:"新密码"}},[s("el-input",{ref:"newPass",attrs:{"show-password":"",clearable:""},model:{value:e.alterForm.newPass,callback:function(t){e.$set(e.alterForm,"newPass",t)},expression:"alterForm.newPass"}})],1),e._v(" "),s("el-form-item",{attrs:{id:"labels",prop:"checkPass",label:"再次输入新密码"}},[s("el-input",{ref:"checkPass",attrs:{"show-password":"",clearable:""},model:{value:e.alterForm.checkPass,callback:function(t){e.$set(e.alterForm,"checkPass",t)},expression:"alterForm.checkPass"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.alterPass}},[e._v("确 定")]),e._v(" "),s("el-button",{on:{click:function(t){return e.cancel("alterForm")}}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var h=s("VU/8")(m,v,!1,function(e){s("oMaO")},"data-v-67c1da8f",null).exports,f=s("tIHl"),p={methods:{removePass:function(){var e=this;Object(f.a)().then(function(){e.$emit("removePass")}).catch(function(){return Object(f.b)("已取消删除","info")})}}},b={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"card card-large-icons"},[t("div",{staticClass:"card-icon bg-primary"},[t("span",{staticClass:"svg-container"},[t("svg-icon",{attrs:{"icon-class":"skull"}})],1)]),this._v(" "),t("div",{staticClass:"card-body"},[t("h4",[this._v("删除账号")]),this._v(" "),t("p",[this._v("您的所有数据都会被删除，无法找回")]),this._v(" "),t("a",{staticClass:"card-cta",on:{click:this.removePass}},[this._v("\n      申请删除\n      "),t("span",{staticClass:"svg-container"},[t("svg-icon",{attrs:{"icon-class":"chevron-right"}})],1)])])])},staticRenderFns:[]};var g=s("VU/8")(p,b,!1,function(e){s("21Fa")},"data-v-c30b6c9c",null).exports,_=s("mvHQ"),F=s.n(_),w=s("Wxq9"),P={props:{visible:Boolean},data:function(){return{area:{options:w.regionData},param:new FormData}},methods:n()({},Object(d.d)(["SET_VISIBLE","SET_AVATAR"]),{handleChange:function(e){this.ruleForm.hometown=e},beforeupload:function(e){var t=e.size/1024/1024<3;if(t){var s=window.URL||window.webkitURL;return this.ruleForm.url=s.createObjectURL(e),this.SET_AVATAR(this.ruleForm.url),this.param.append("file",e,e.name),!1}return t||Object(f.b)("上传头像图片大小不能超过 3MB!","error"),t},setPersonal:function(){this.ruleForm.username=this.name,this.param.append("message",F()(this.ruleForm)),this.$emit("setUserInfo",this.param),this.reset()},hide:function(){this.SET_VISIBLE(!1),this.reset()},show:function(){this.SET_VISIBLE(!0),this.$emit("getPersonal")},reset:function(){this.$refs.ruleForm.resetFields(),this.$refs.cascader.checkedValue=null,this.ruleForm.url=""}}),computed:n()({},Object(d.c)(["name"]),Object(d.e)({ruleForm:function(e){return e.account.form}}))},C={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"card card-large-icons"},[s("div",{staticClass:"card-icon bg-primary"},[s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"shield"}})],1)]),e._v(" "),s("div",{staticClass:"card-body"},[s("h4",[e._v("个人信息")]),e._v(" "),s("p",[e._v("个性化设置资料,如上传/修改头像等")]),e._v(" "),s("a",{staticClass:"card-cta",on:{click:e.show}},[e._v("\n      立即设置\n      "),s("span",{staticClass:"svg-container"},[s("svg-icon",{attrs:{"icon-class":"chevron-right"}})],1)])]),e._v(" "),s("el-dialog",{attrs:{top:"2%",width:"50%",title:"个人信息",visible:e.visible},on:{close:e.hide}},[s("el-form",{ref:"ruleForm",staticClass:"bg-form",attrs:{model:e.ruleForm,"label-position":"right","label-width":"80px"}},[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{prop:"nickname",id:"labels",label:"昵称"}},[s("el-input",{attrs:{type:"nickname",clearable:""},model:{value:e.ruleForm.nickname,callback:function(t){e.$set(e.ruleForm,"nickname",t)},expression:"ruleForm.nickname"}})],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{id:"labels",prop:"sex",label:"性别"}},[s("el-radio",{attrs:{label:"男",border:"",size:"small"},model:{value:e.ruleForm.sex,callback:function(t){e.$set(e.ruleForm,"sex",t)},expression:"ruleForm.sex"}},[e._v("男")]),e._v(" "),s("el-radio",{attrs:{label:"女",border:"",size:"small"},model:{value:e.ruleForm.sex,callback:function(t){e.$set(e.ruleForm,"sex",t)},expression:"ruleForm.sex"}},[e._v("女")])],1),e._v(" "),s("el-form-item",{attrs:{prop:"sex",label:"生日"}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{prop:"birthday"}},[s("el-date-picker",{staticStyle:{width:"84%"},attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.ruleForm.birthday,callback:function(t){e.$set(e.ruleForm,"birthday",t)},expression:"ruleForm.birthday"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{id:"labels",prop:"job",label:"职业"}},[s("el-input",{attrs:{clearable:""},model:{value:e.ruleForm.job,callback:function(t){e.$set(e.ruleForm,"job","string"==typeof t?t.trim():t)},expression:"ruleForm.job"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{id:"labels",prop:"hometown",label:"家乡"}},[s("el-cascader",{ref:"cascader",staticStyle:{width:"100%"},attrs:{options:e.area.options,clearable:""},on:{change:e.handleChange},model:{value:e.ruleForm.hometown,callback:function(t){e.$set(e.ruleForm,"hometown",t)},expression:"ruleForm.hometown"}})],1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"头像",prop:"avatar"}},[s("el-upload",{attrs:{action:"#","list-type":"picture-card",limit:1,"before-upload":e.beforeupload,accept:"image/*"}},[s("i",{staticClass:"showPic el-icon-plus"})])],1)],1),e._v(" "),s("el-col",{attrs:{span:6,offset:3}},[s("el-image",{staticClass:"showPic showPic-success",attrs:{src:e.ruleForm.url,"preview-src-list":[e.ruleForm.url],width:"80%"}},[s("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[s("i",{staticClass:"showPic-error showPic el-icon-picture-outline",staticStyle:{fontsize:"30px"}})])])],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"个性签名",id:"labels",prop:"desc"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.desc,callback:function(t){e.$set(e.ruleForm,"desc",t)},expression:"ruleForm.desc"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.setPersonal}},[e._v("提 交")]),e._v(" "),s("el-button",{on:{click:e.hide}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var k=s("VU/8")(P,C,!1,function(e){s("a4eK")},"data-v-9fc400d6",null).exports,x=s("2CHa");var y={name:"personal",components:{ChangePass:h,DeleteInfo:g,PersonAccount:k},data:function(){return{}},methods:n()({},Object(d.d)(["SET_VISIBLE"]),Object(d.b)(["alterPass","deleteUser","setInfo","getInfo"]),{changePass:function(e){var t=this;this.alterPass(e).then(function(){t.alertAlter()})},setUserInfo:function(e){var t=this;return o()(r.a.mark(function s(){return r.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,t.setInfo(e);case 3:t.alertSet(),s.next=9;break;case 6:s.prev=6,s.t0=s.catch(0),t.alertSet();case 9:case"end":return s.stop()}},s,t,[[0,6]])}))()},getPersonal:function(){this.getInfo({params:{username:this.name}})},removePass:function(){var e=this,t={username:this.name};this.deleteUser(t).then(function(){e.alertDel()}).catch(function(){e.alertDel()})},alertAlter:function(){var e;"SUCCESS"===(e=this.status)?swal({title:"修改密码成功!",text:"请重新登录",icon:"success",button:"OK"}).then(function(){Object(x.b)(),window.history.go(0)}):"PASSWORD_ERROR"===e&&swal({title:"修改密码失败!",text:"原密码错误",icon:"error",button:"OK"})},alertDel:function(){"SUCCESS"===this.status?swal({title:"删除账号成功!",icon:"success",button:"OK"}).then(function(){Object(x.b)(),window.history.go(0)}):swal({title:"删除失败,网络好像出了小差～",text:"请重试",icon:"error",button:"OK"})},alertSet:function(){var e,t=this;(e=this.status,"SUCCESS"===e?swal({title:"设置成功!",icon:"success",button:"OK"}):"UPDATE"===e?swal({title:"更新成功!",icon:"success",button:"OK"}).then(function(){}):swal({title:"设置失败,网络好像出了小差～",text:"请重试",icon:"error",button:"OK"})).then(function(){t.SET_VISIBLE(!1)})}}),computed:n()({},Object(d.c)(["e_mail","name"]),Object(d.e)({status:function(e){return e.account.status},visible:function(e){return e.account.visible}}))},S={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"personal"},[s("div",{staticClass:"grey_bg"},[s("div",{staticClass:"content"},[s("section",{staticClass:"list"},[s("div",{staticClass:"card card-profile"},[s("div",{staticClass:"card-main"},[s("ul",{staticClass:"card-inner essay-card"},[s("li",[s("section",{staticClass:"section"},[e._m(0),e._v(" "),s("div",{staticClass:"section-body"},[s("h2",{staticClass:"section-title"},[e._v("欢迎, "+e._s(e.name)+"!")]),e._v(" "),s("p",{staticClass:"section-lead"},[e._v(e._s(e.e_mail))]),e._v(" "),s("div",{staticClass:"row mt-sm-4"},[s("div",{staticClass:"col-lg-6"},[s("ChangePass",{on:{alterPass:e.changePass}})],1),e._v(" "),s("div",{staticClass:"col-lg-6"},[s("PersonAccount",{attrs:{visible:e.visible},on:{getPersonal:e.getPersonal,setUserInfo:e.setUserInfo}})],1),e._v(" "),s("div",{staticClass:"col-lg-6"},[s("DeleteInfo",{on:{removePass:e.removePass}})],1)])])])])])])])])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"section-header"},[t("h1",[this._v("我的账号")])])}]};var O=s("VU/8")(y,S,!1,function(e){s("Wjzr")},"data-v-d991476a",null);t.default=O.exports},"21Fa":function(e,t){},Wjzr:function(e,t){},a4eK:function(e,t){},oMaO:function(e,t){}});
//# sourceMappingURL=8.7b78332e541c0ce28afc.js.map